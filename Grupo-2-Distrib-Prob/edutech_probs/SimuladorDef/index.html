<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Simulador de Truel (3 tiradores)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="container">
    <header class="top-header">
      <h1>Simulador de duelo entre 3 contendientes</h1>
      <p class="subtitle">
        Explora un duelo entre tres contendientes con diferentes probabilidades de acierto. Ajusta estrategias,
        modos de turno y observa el comportamiento del sistema tanto estad√≠sticamente como partida a partida.
      </p>

      <nav class="top-nav">
        <button class="nav-btn active" data-view-target="config">
          Configuraci√≥n
        </button>
        <button class="nav-btn" data-view-target="standard">
          Simulaci√≥n est√°ndar
        </button>
        <button class="nav-btn" data-view-target="single">
          Simulaci√≥n de una partida
        </button>
      </nav>
    </header>

    <!-- VISTA: CONFIGURACI√ìN -->
    <section id="view-config" class="view active-view">
      <!-- 1. CONFIGURACI√ìN DE JUGADORES -->
      <section class="card">
        <h2>1. Configuraci√≥n de los jugadores</h2>
        <p class="small">
          Las probabilidades deben estar estrictamente entre 0 y 1 (sin incluirlos). Puedes escribir decimales
          (ej. <code>0.7</code>) o fracciones (ej. <code>2/3</code>, <code>7/10</code>).
        </p>

        <div class="players-grid">
          <!-- Jugador A -->
          <div class="player-block">
            <h3>Jugador A</h3>
            <label>
              Nombre:
              <input type="text" id="nameAInput" placeholder="Jugador A" />
            </label>
            <label>
              Probabilidad de acierto:
              <input type="text" id="pA" value="2/3" />
            </label>
            <label>
              Estrategia:
              <select id="sA">
                <option value="strongest">Disparar al m√°s fuerte</option>
               <!-- <option value="weakest">Disparar al m√°s d√©bil</option> -->
                <option value="random">Disparar aleatoriamente</option>
                <!-- <option value="skip">Fallar a prop√≥sito (no dispara)</option>  -->
              </select>
            </label>
          </div>

          <!-- Jugador B -->
          <div class="player-block">
            <h3>Jugador B</h3>
            <label>
              Nombre:
              <input type="text" id="nameBInput" placeholder="Jugador B" />
            </label>
            <label>
              Probabilidad de acierto:
              <input type="text" id="pB" value="1/2" />
            </label>
            <label>
              Estrategia:
              <select id="sB">
                <option value="strongest">Disparar al m√°s fuerte</option>
               <!-- <option value="weakest">Disparar al m√°s d√©bil</option> -->
                <option value="random">Disparar aleatoriamente</option>
               <!-- <option value="skip">Fallar a prop√≥sito (no dispara)</option> -->
              </select>
            </label>
          </div>

          <!-- Jugador C -->
          <div class="player-block">
            <h3>Jugador C</h3>
            <label>
              Nombre:
              <input type="text" id="nameCInput" placeholder="Jugador C" />
            </label>
            <label>
              Probabilidad de acierto:
              <input type="text" id="pC" value="1/3" />
            </label>
            <label>
              Estrategia:
              <select id="sC">
                <option value="strongest">Disparar al m√°s fuerte</option>
                <!-- <option value="weakest">Disparar al m√°s d√©bil</option> -->
                <option value="random">Disparar aleatoriamente</option>
                <!-- <option value="skip">Fallar a prop√≥sito (no dispara)</option> -->
              </select>
            </label>
          </div>
        </div>

        <div id="errorBox" class="error-list"></div>
      </section>

      <!-- 2. REGLAS DE TURNO -->
      <section class="card">
        <h2>2. Reglas de turno</h2>

        <label>
          Modo de turno:
          <select id="turnMode">
            <option value="fixed">Orden fijo (c√≠clico)</option>
            <option value="random">Orden aleatorio (cada turno se elige tirador al azar entre los vivos)</option>
          </select>
        </label>

        <div id="fixedOrderConfig" class="fixed-order-config hidden">
          <label>Orden fijo personalizado:</label>
          <div class="fixed-order-row">
            <select id="fixed1">
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
            </select>
            <span class="fixed-arrow">‚Üí</span>
            <select id="fixed2">
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
            </select>
            <span class="fixed-arrow">‚Üí</span>
            <select id="fixed3">
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
            </select>
          </div>
          <p class="small">
            Debes usar exactamente una vez a A, B y C (por ejemplo A ‚Üí B ‚Üí C).
          </p>
        </div>

        <p class="small" style="margin-top:0.6rem;">
          Esta configuraci√≥n se utilizar√° tanto en la simulaci√≥n est√°ndar como en la simulaci√≥n de una sola partida.
        </p>
      </section>
    </section>

    <!-- VISTA: SIMULACI√ìN EST√ÅNDAR -->
    <section id="view-standard" class="view">
      <section class="card">
        <h2>Simulaci√≥n est√°ndar (muchas partidas)</h2>

        <p class="small">
          Usa la configuraci√≥n actual de jugadores y reglas de turno. Aqu√≠ solo eliges cu√°ntas partidas simular
          y si quieres ver una demostraci√≥n visual.
        </p>

        <label>
          N√∫mero de partidas a simular:
          <input type="number" id="numSim" value="10000" min="1" />
        </label>

        <label class="demo-option">
          <input type="checkbox" id="demoMode" />
          Modo demostraci√≥n visual (hasta 1000 partidas recomendado)
        </label>

        <div class="speed-control">
          <label for="demoSpeed">
            Velocidad de la demostraci√≥n:
            <input type="range" id="demoSpeed" min="1" max="5" step="1" value="3" />
            <span id="demoSpeedLabel">media</span>
          </label>
        </div>

        <div class="buttons-row">
          <button id="runStatsBtn">Ejecutar simulaci√≥n</button>
          <button id="pauseStatsBtn" class="secondary" disabled>Pausar simulaci√≥n</button>
        </div>

        <div id="status" class="status"></div>

        <div id="results" class="results"></div>

        <div id="graphContainer">
          <p class="small">
            En modo demostraci√≥n visual se muestran las partidas como un peque√±o grafo:
            tres nodos (jugadores) y disparos representados lineas.
            A la derecha se ve el mismo proceso descrito turno a turno en texto.
            <br />
            <strong>Colores:</strong> azul = tirador, rojo = objetivo, verde = impacto, naranja = fallo, gris = eliminado.
          </p>

          <div class="graph-layout">
            <canvas id="graphCanvas" width="640" height="260"></canvas>
            <pre id="demoLog" class="log graph-log"></pre>
          </div>
        </div>
      </section>
    </section>

    <!-- VISTA: SIMULACI√ìN DE UNA PARTIDA -->
    <section id="view-single" class="view">
      <section class="card">
        <h2>Simulaci√≥n de una partida</h2>
        <p class="small">
          Elige si quieres ver la partida como un log de texto o como una animaci√≥n tipo juego.
          Usa la misma configuraci√≥n de la pesta√±a ‚ÄúConfiguraci√≥n‚Äù.
        </p>

        <div class="single-nav">
          <button class="single-nav-btn active" data-single-target="text">Simulaci√≥n con texto</button>
          <button class="single-nav-btn" data-single-target="anim">Simulaci√≥n animada</button>
        </div>
      </section>

      <!-- Panel texto -->
      <section id="single-text" class="card single-panel active-single">
        <h3>Partida con log textual</h3>
        <p class="small">
          Corre una sola partida con las reglas actuales y mira la ‚Äúbit√°cora‚Äù completa turno a turno.
        </p>
        <button id="runOneBtn">Simular una partida (texto)</button>
        <pre id="log" class="log"></pre>
      </section>

      <!-- Panel animado -->
      <section id="single-anim" class="card single-panel">
        <h3>Partida animada</h3>
        <p class="small">
          Visualiza qui√©n dispara a qui√©n en cada turno. Es el mismo modelo probabil√≠stico,
          presentado como un peque√±o juego.
        </p>

        <div class="arena" id="arena">
          <div class="fighter" data-player="A">
            <div class="fighter-avatar">üêí</div>
            <div class="fighter-name" id="arenaNameA">A</div>
            <div class="fighter-prob" id="arenaProbA">p = ?</div>
            <div class="fighter-state" id="arenaStateA">En juego</div>
          </div>
          <div class="fighter" data-player="B">
            <div class="fighter-avatar">üê∫</div>
            <div class="fighter-name" id="arenaNameB">B</div>
            <div class="fighter-prob" id="arenaProbB">p = ?</div>
            <div class="fighter-state" id="arenaStateB">En juego</div>
          </div>
          <div class="fighter" data-player="C">
            <div class="fighter-avatar">ü¶ñ</div>
            <div class="fighter-name" id="arenaNameC">C</div>
            <div class="fighter-prob" id="arenaProbC">p = ?</div>
            <div class="fighter-state" id="arenaStateC">En juego</div>
          </div>
        </div>

        <div class="speed-control">
          <label for="animSpeed">
            Velocidad de la animaci√≥n:
            <input type="range" id="animSpeed" min="1" max="5" step="1" value="3" />
            <span id="animSpeedLabel">media</span>
          </label>
        </div>

        <div class="arena-controls">
          <button id="startAnimatedBtn">Iniciar partida animada</button>
          <button id="stopAnimatedBtn" class="secondary">Detener</button>
        </div>

        <p class="small">
          <strong>Colores:</strong> azul = tirador, rojo = objetivo, gris apagado = jugador eliminado.
        </p>

        <div id="animatedInfo" class="status"></div>

        <div id="animGraphContainer" class="graph-mini">
          <canvas id="animGraphCanvas" width="360" height="180"></canvas>
        </div>

        <pre id="animatedLog" class="log"></pre>
      </section>
    </section>

    <p class="subtitle">
      <i>Desarrollado por Juan Sebastian Colorado Caro - 20202673001 - jscoloradoc@udistrital.edu.co 
        y Juan Daniel Vanegas Mayorquin - 20222020077 - jdvanegasm@udistrital.edu.co 
        bajo la tutoria del profesor Fernando Leon Parada, Doctor en Educaci√≥n Matem√°tica DIE-UD.
        Facultad de Ingenier√≠a, Universidad Distrital Francisco Jos√© de Caldas.</i>
    </p>
  </main>

  <script type="module" src="main.js"></script>
</body>
</html>
